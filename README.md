# PROJECT-3. EDA + Feature Engineering. Соревнование на Kaggle

### Оглавление 
[1. Описание проекта](https://github.com/IgorAbalakin/Booking_data_project/blob/main/README.md#Описание-проекта) 

[2. Исследование данных, анализ признаков](https://github.com/IgorAbalakin/Booking_data_project/blob/main/README.md#Исследование&nbsp;данных","&nbsp;анализ&nbsp;признаков) 

[3. Удаление дубликатов, заполнение пропусков, обработка текста](https://github.com/IgorAbalakin/Booking_data_project/blob/main/README.md#Удаление&nbsp;дубликатов","&nbsp;заполнение&nbsp;пропусков","&nbsp;обработка-текста) 

[4. Создание новых признаков](https://github.com/IgorAbalakin/Booking_data_project/blob/main/README.md#Создание-новых-признаков) 

[5. Нормализация данных](https://github.com/IgorAbalakin/Booking_data_project/blob/main/README.md#Нормализация-данных) 

[6. Кодирование признаков](https://github.com/IgorAbalakin/Booking_data_project/blob/main/README.md#Кодирование-признаков) 

[7. Очистка данных](https://github.com/IgorAbalakin/Booking_data_project/blob/main/README.md#Очистка-данных) 

[8. Анализ мультиколлинеарности](https://github.com/IgorAbalakin/Booking_data_project/blob/main/README.md#Анализ-мультиколлинеарности) 

[9. Проверка важности признаков](https://github.com/IgorAbalakin/Booking_data_project/blob/main/README.md#Проверка-важности-признаков) 

[10. Обучение модели](https://github.com/IgorAbalakin/Booking_data_project/blob/main/README.md#Обучение-модели) 
 
____
### Описание проекта 
Одна из проблем компании Booking — это нечестные отели, которые накручивают себе рейтинг. Одним из способов обнаружения таких отелей является построение модели, которая предсказывает рейтинг отеля. Если предсказания модели сильно отличаются от фактического результата, то, возможно, отель ведёт себя нечестно, и его стоит проверить.
 
:arrow_up: [к оглавлению](https://github.com/IgorAbalakin/Booking_data_project/blob/main/README.md#Оглавление)

 ____
### Исследование данных, анализ признаков
[hotels.csv](https://drive.google.com/file/d/1WWv9ARJ7icmt5Gq7XTogqvq95-7jQb_7/view?usp=sharing)

Исходный файл представляет собой dataframe из 386803 объектов (отзывы на отели) с 17 признаками (адрес, название отеля, содержание отзыва, общее количество отзывов и т.д). В двух из них (географические координаты) присутствуют пропуски. Более всего на целевой признак (оценка отзыва) влияют содержание, длина отзыва и средний ретйинг отеля.

:arrow_up: [к оглавлению](https://github.com/IgorAbalakin/Booking_data_project/blob/main/README.md#Оглавление)

____
### Удаление дубликатов, заполнение пропусков, обработка текста

Предварительная обработка текста влючала в себя разделения текста отзыва на слова, приведение к нижнему регистру, отбрасывание пунктуации и стоп слов, выделение корней из полученных слов.

В найденном датасете было найденно и удалено 307 полных дубликатов. 

Пропуски в географических координатах восстанавливались по адресу отеля, используя geocoder

:arrow_up: [к оглавлению](https://github.com/IgorAbalakin/Booking_data_project/blob/main/README.md#Оглавление)

 ____
### Создание новых признаков

1. Извлечение признаков из содержания отзыва

    1.1. Количество (абсолютное) уникальных для положительного/отрицательного отзыва слов (корней слов)

    1.2. Удельное количество уникальных слов на общую длину положительного/отрицательного отзыва

    1.3. Общая длина обработанного (очщенного отзыва)

    1.4. Анализ тональности с помощью TextBlob

    1.5. Анализ тональности с помощью Vader

2. Извлечение признаков из даты отзывов

    2.1. Месяц

    2.2. Год

    2.3. День недели

    2.4. Выходной день (да/нет)

3. Извлечение признаков из адреса отеля

    3.1. Название города

    3.2. Координаты центра города

    3.3. Расстояние от центра города до отеля

    3.4. Название страны

4. Теги

    4.1. Общее количество тегов

    4.2. Продолжительность пребывания (количество ночей)

    4.3. Тип комнаты.

    4.4. Условия, описание поездки (деловая поездка, с детьми, с животными и т.д.)



:arrow_up: [к оглавлению](https://github.com/IgorAbalakin/Booking_data_project/blob/main/README.md#Оглавление)
____
### Нормализация данных

Все числовые признаки с щироким диапазоном значений логарифмируются.
Нормализация и стандартизация данных признаков не позволяли повысить точность модели.

:arrow_up: [к оглавлению](https://github.com/IgorAbalakin/Booking_data_project/blob/main/README.md#Оглавление)
____
### Кодирование признаков

Лучший результат (точность модели) был получен после применения LabelEncoder к пяти категориальным признакам. В данных признаков были оставлены 10-50 наиболее популярных вариантов.

:arrow_up: [к оглавлению](https://github.com/IgorAbalakin/Booking_data_project/blob/main/README.md#Оглавление)
____
### Очистка данных

Удалены вспомогательные признаки (координаты отеля и центра города, дата отзыва), а также все признаки типа object.

:arrow_up: [к оглавлению](https://github.com/IgorAbalakin/Booking_data_project/blob/main/README.md#Оглавление)
____
### Анализ мультиколлинеарности

Был получен список сильно коррелированных признако (более 0.7) и удалены по одному из пары (8 признаков).

:arrow_up: [к оглавлению](https://github.com/IgorAbalakin/Booking_data_project/blob/main/README.md#Оглавление)
____
### Проверка важности признаков

Была оценена важность количественных признаков с использованием теста ANOVA, 2 наиболее слабых признака (рейтинг менее 100) не брались далее в рассмотрение. Аналогично с тестом хи-квадрат были оценены категориальные признаки. Удалены 5 признаков с рейтингом менее 100. Таким образом, для обучения модели использовались 34 признака. 

:arrow_up: [к оглавлению](https://github.com/IgorAbalakin/Booking_data_project/blob/main/README.md#Оглавление)
____
### Обучение модели

Точность обучения модели (MAPE) - 12.187 %. Исходный результат удалось улучшить на 1.951 %. 
Аккаунт на [kaggle](https://www.kaggle.com/abalakinigor), где можно посмотреть результат соревнования. 

:arrow_up: [к оглавлению](https://github.com/IgorAbalakin/Booking_data_project/blob/main/README.md#Оглавление)